<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="img/artor.png" sizes="16x16">
  <meta name="viewport" content="width=device-width" />
  <title>随机抽签</title>

  <link rel="stylesheet" href="css/normalize.css" />
  <link rel="stylesheet" href="css/foundation.css" />
  <script src="js/vendor/custom.modernizr.js"></script>
  <script src="js/jquery-latest.min.js"></script>

<style>
#values { position:relative;font-size:400%;text-align:center;margin: 0 auto;z-index:0; }
.name { overflow:hidden;display:block; }
#names { display:none;padding:5px; }
#namesbox { min-height:400px;font-size:32px;color:#333;resize:none;border:1px solid #F39C12; }
.extra { font-size:16px;margin-top:20px; }
#result1 { background:#000;color:#fbe34b;padding:20px;z-index:10;margin-top:-150px; }
body { background:#F1C40F url(img/bg-noise-orange.png); }
#varnote { font-size:40px;text-align:center;padding:30px; }
.icon {width:100px;height:100px;}
.copyright { font-size:11px;font-family:Tahoma;color:#9B59B6; }
</style>

</head>
<body onload="reset();">

  <div class="full-head" style="width:100%;background:#111 url(img/header-bg.png) repeat-x center top;border-bottom:1px solid #D35400;">
	<div class="row">
		<div class="large-12 columns" style="padding-top:50px;background:#111 url(img/header-bg.png) repeat-x center top;z-index:20;">
		<ul class="button-group even-4">
      <li><a href="index.html" class="alert button" id="reset">重开</a></li>
			<li><button class="button" id="list" onclick="namelist();">名单</button></li>
			<li><button class="button" id="save" onclick="save();">保存 &amp; 更新</button></li>
			<li><button class="success button" id="go" onclick="go();">开始!</button></li>
    </ul>
		</div>
	</div>
	</div>

	<div class="row">
		<div class="large-12 columns">
			<h3 style="text-align:center;margin-top:30px;" id="headline">让我们看看谁是幸运儿吧？</h3>
			
			<div id="varnote"><img class="icon" src="img/artor.png"><div class="copyright">&copy; Coded by <strong>ARTOR</strong>, September 2021</div></div>
			
      <div id="popdown">
      <div id="names" class="inbox"><textarea name="namesbox" id="namesbox"></textarea></div>
      </div>
      
      <div id="values"></div>


		</div>
	</div>

  <script>
  document.write('<script src=' +
  ('__proto__' in {} ? 'js/vendor/zepto' : 'js/vendor/jquery') +
  '.js><\/script>')
  </script>
  
  <script src="js/foundation.min.js"></script>
  <script>$(document).foundation();</script>
  
<script>
var text;
var names = new Array(
						'玛丽亚木·塔什',
						'艾珂丹姆·艾合旦木江',
						'艾孜海江·阿依甫',
						'乃皮赛·艾力',
						'阿尔祖古丽·艾孜提艾',
						'努尔比耶古丽·萨迪克',
						'艾丽非热·玉苏甫',
						'穆耶赛尔·艾力木',
						'伊力哈木·阿卜力皮孜',
						'阿地拉·艾米都力',
						'古再力努尔·阿不都瓦',
						'古丽孜米拉·阿不都',
						'努尔比耶·衣沙克',
						'凯迪日耶·吐拉洪',
						'开日木拉·麦麦提尼亚',
						'依再提古丽·阿不都依',
						'哈力木拉提·吾布力',
						'安尼外尔·麦麦提图尔',
						'木艾热木·吐尔送托合',
						'孜拉力·艾买尔',
						'阿迪莱·阿卜杜许库尔',
						'阿尔祖古丽·麦麦提',
						'依布拉音·艾沙',
						'古力先·于苏因',
						'亚森·阿布都热依木',
						'古丽米热·努尔阿卜拉',
						'努尔比那·台外库力',
						'沙吾尔江·阿布都克尔',
						'图尔迪·麦麦提',
						'阿卜力提普·艾则孜',
						'色力木古丽·麦麦提',
						'阿卜力克木·阿卜来提',
						'其曼古·吐送巴克',
						'阿卜杜哈力克·阿卜杜',
						'比乃再尔·凯尤木',
						'阿卜力孜·麦麦提纳斯'
                      );

function reset(){
  // re-enable go button
  setTimeout("$('#go').removeAttr('disabled')",11005);
  var namesbreak = "";
  if(gup('names') != ""){
    var names = gup('names');
    namesbreak = names.replace(/101/g,'\n');
    namesbreak = namesbreak.replace(/%20/g,' ');          
    }
    else   {
      var names = new Array('玛丽亚木·塔什',
						'艾珂丹姆·艾合旦木江',
						'艾孜海江·阿依甫',
						'乃皮赛·艾力',
						'阿尔祖古丽·艾孜提艾',
						'努尔比耶古丽·萨迪克',
						'艾丽非热·玉苏甫',
						'穆耶赛尔·艾力木',
						'伊力哈木·阿卜力皮孜',
						'阿地拉·艾米都力',
						'古再力努尔·阿不都瓦',
						'古丽孜米拉·阿不都',
						'努尔比耶·衣沙克',
						'凯迪日耶·吐拉洪',
						'开日木拉·麦麦提尼亚',
						'依再提古丽·阿不都依',
						'哈力木拉提·吾布力',
						'安尼外尔·麦麦提图尔',
						'木艾热木·吐尔送托合',
						'孜拉力·艾买尔',
						'阿迪莱·阿卜杜许库尔',
						'阿尔祖古丽·麦麦提',
						'依布拉音·艾沙',
						'古力先·于苏因',
						'亚森·阿布都热依木',
						'古丽米热·努尔阿卜拉',
						'努尔比那·台外库力',
						'沙吾尔江·阿布都克尔',
						'图尔迪·麦麦提',
						'阿卜力提普·艾则孜',
						'色力木古丽·麦麦提',
						'阿卜力克木·阿卜来提',
						'其曼古·吐送巴克',
						'阿卜杜哈力克·阿卜杜',
						'比乃再尔·凯尤木',
						'阿卜力孜·麦麦提纳斯'
                      );
    for(var i in names){
      name = names[i];
      if (name == "" || typeof(name) == undefined){}else{
         namesbreak = namesbreak + name + "\n";
      }
    }
  }
  $("#namesbox").val(namesbreak);
}

function gup(para)
{
  para = para.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+para+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}

function randOrd(){
	return (Math.round(Math.random())-0.5); 
}

function save(){
        $("#varnote").hide();
        $("#popdown").show();
        $("#values").hide();
        $("div").remove("#result1");
        savenames = $("#namesbox").val();
        savenames = savenames.replace(/\n\r?/g, '101');
        $('#headline').fadeOut();
        $('#headline').text('The name list is saved and updated.').fadeIn();
        $("#names").show();
        $('#namesbox').attr('disabled','disabled');
}

function namelist(){
        $("#varnote").hide();
        $('#namesbox').removeAttr('disabled','disabled');
        $('#headline').text('Configure name list');
        $("#popdown").show();
        $("#values").hide();
        $("#names").show();
        $('body').css({"overflow-y": "visible"});
}

// does the actual animation
function go(){
  $("#varnote").hide();
  $('body').css({"overflow-y": "hidden"});
  $('#go').attr('disabled','disabled');
  $('#list').attr('disabled','disabled');
  $('#save').attr('disabled','disabled');
  $('#headline').slideUp();
  $('#namesbox').slideDown();

  var count = 1;
  count = 1;
  $("div").remove("#result1");
  names = $("#namesbox").val();
  if(document.all) { // IE
    names=names.split("\n");
  }
  else { //Mozilla
    names=names.split("\n");
  }
  $("#values").show();
  $(".name").show();
  $("#popdown").hide();
  $("div").remove(".name");
  $("div").remove(".extra");
  $("#playback").html("");
  newtop = names.length * 200 * -1;
  //$('#values').css({top: -300});
  $('#values').css({top: + newtop});	
  names.sort( randOrd );
  var fruits = new Array ( "apple", "pear", "orange", "banana" );
  //console.log(fruits);
  //console.log(names);
  //alert(newtop);
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){
      count = count-1;
    } else {
      name = names[i];
      //console.log(name);
      $('#values').append('<div id=result'+count+' class=name>'+name+'</div>');
    }
    count = count+1;
  }
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){}else{
      name = names[i];
      $('#values').append('<div class=name>'+name+'</div>');
    }
    count = count+1;
  }
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){}else{
      name = names[i];
      $('#values').append('<div class=name>'+name+'</div>');
    }
    count = count+1;
  }
  text = $('#result1').text()
  $('#values').animate({top: '+176'},5000);

  // make it stand out
  setTimeout("standout(text)",5000);
  //setTimeout("$('#playback').hide('slow')",11005);
}

function standout(text){

        $('#result1').removeClass('name');
        $('.name').animate({opacity: .25});
        $('#result1').animate({height: '+=60px'});
        $('#result1').append('<div class="extra"><a class="small alert button" href="#" onClick="removevictim();">列表中清除</a></div>');
        $('#go').removeAttr('disabled','disabled');
        $('#list').removeAttr('disabled','disabled');
        $('#save').removeAttr('disabled','disabled');
        $('#headline').text('获胜者！');
        $('#headline').slideDown();
}

function removevictim(){
	// Removing victim from array and UI
	// names = names.filter(function(){ return true});
	// Rewriting namesbox contents
	var nameupdated = "";
	for(var i in names){
		name = names[i];
                if (name == "" || name == text || typeof(name) == undefined){}else{
			nameupdated = nameupdated + "\n" + name;
		}
	}
	$('#namesbox').val("");
  $('#namesbox').val(nameupdated);
  $('#result1').html("已清除");
  $('#result1').fadeOut(1000, function(){
    $("div").remove("#result1");
  });
  $("div").remove(".name");
  $("div").remove(".extra");
  $('#headline').text('OK, 谁是下一个？');
}

</script>

</body>
</html>
